<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plant Quest: Winner Character üåø</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Poppins', sans-serif; background: #e8f5e9 url('game_bg.jpg') no-repeat center center fixed; background-size: cover; display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; color: #2e7d32; overflow: hidden; }
        .game-container { background: rgba(255, 255, 255, 0.9); border-radius: 30px; padding: 25px; box-shadow: 0 15px 35px rgba(0,0,0,0.2); width: 90%; max-width: 450px; text-align: center; border: 5px solid #4caf50; backdrop-filter: blur(5px); }
        .level-badge { background: #4caf50; color: white; padding: 5px 15px; border-radius: 20px; display: inline-block; font-size: 0.8rem; margin-bottom: 15px; font-weight: bold; }
        .btn-choice { background: #fff; border: 2px solid #4caf50; color: #2e7d32; padding: 12px; margin: 8px 0; width: 100%; border-radius: 12px; cursor: pointer; font-family: 'Poppins'; font-weight: bold; text-align: left; transition: 0.2s; }
        .btn-choice:hover { background: #e8f5e9; transform: scale(1.02); }
        .btn-main { background: #ff9800; color: white; border: none; padding: 15px 40px; border-radius: 50px; font-size: 1.2rem; cursor: pointer; font-weight: bold; box-shadow: 0 5px 0 #e68a00; transition: 0.2s; }
        .btn-main:active { transform: translateY(3px); box-shadow: 0 2px 0 #e68a00; }
        .overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); display: none; flex-direction: column; justify-content: center; align-items: center; color: white; z-index: 100; text-align: center; padding: 20px; }
        .input-field { width: 80%; padding: 12px; border-radius: 10px; border: 2px solid #4caf50; text-align: center; font-family: 'Poppins'; margin-bottom: 15px; font-size: 1.1rem; outline: none; }
        
        /* Gaya untuk video pemenang */
        .win-video { width: 280px; border-radius: 20px; border: 5px solid #ffeb3b; box-shadow: 0 0 20px rgba(255, 235, 59, 0.5); margin-bottom: 20px; }
    </style>
</head>
<body>

    <div id="login-screen" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: white; display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 300;">
        <h1 style="color: #4caf50;">üå± Plant Quest</h1>
        <p>Tumbuhkan tanamanmu dengan pengetahuan!</p>
        <input type="text" id="playerName" class="input-field" placeholder="Nama Pekebun...">
        <button class="btn-main" onclick="startGame()">GAS MULAI</button>
    </div>

    <div class="game-container">
        <div class="level-badge" id="levelLabel">LEVEL 1</div>
        <div style="display: flex; justify-content: space-between; font-weight: bold; font-size: 0.9rem; margin-bottom: 10px;">
            <span id="displayName"></span>
            <span id="heartsContainer">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</span>
        </div>

        <div id="area-quiz">
            <div id="question-box" style="background:#f0fdf4; padding:15px; border-radius:15px; margin-bottom:15px; font-weight:bold; color:#333; min-height: 60px;"></div>
            <div id="options-area"></div>
        </div>

        <div id="area-lvl2" style="display:none;">
            <div style="height: 150px; display: flex; align-items: flex-end; justify-content: center; margin-bottom: 10px;">
                <img src="pohon_kecil.png" style="max-height: 100%;">
            </div>
            <p id="hint-box" style="font-weight:bold; color:#333; margin-bottom:15px;"></p>
            <input type="text" id="typeAnswer" class="input-field" placeholder="Ketik jawaban..." autocomplete="off">
            <button class="btn-main" style="font-size:1rem; padding:10px 25px;" onclick="checkTypeAnswer()">KIRIM JAWABAN</button>
        </div>
    </div>

    <div class="overlay" id="levelUpScreen">
        <video id="winVid" class="win-video" playsinline loop>
            <source src="winner_character.mp4" type="video/mp4">
        </video>
        <h1 style="color: #ffeb3b;">LEVEL BERHASIL! üÜô</h1>
        <p>Tanamanmu senang sekali!</p>
        <button class="btn-main" onclick="nextLevel()">LANJUT LEVEL</button>
    </div>

    <div class="overlay" id="winScreen">
        <video id="finalWinVid" class="win-video" playsinline loop>
            <source src="winner_character.mp4" type="video/mp4">
        </video>
        <h1 style="color: #4caf50; font-size: 2.5rem;">MASTER GARDENER! üèÜ</h1>
        <button class="btn-main" onclick="location.reload()">MAIN LAGI</button>
    </div>

    <div class="overlay" id="loseScreen">
        <h1 style="color: #ff4757; font-size: 2.5rem;">BELUM BERHASIL üò≠</h1>
        <p>Ayo asah lagi pengetahuanmu!</p>
        <button class="btn-main" onclick="location.reload()">COBA LAGI</button>
    </div>

    <audio id="bgm" src="bgm_game.m4a" loop></audio>
    <audio id="sfxCorrect" src="correct_sound.m4a"></audio>
    <audio id="sfxWrong" src="wrong_sound.m4a"></audio>
    <audio id="sfxType" src="typing_sound.m4a" preload="auto"></audio>
    <audio id="sfxWin" src="win_sound.m4a"></audio>
    <audio id="sfxLose" src="lose_sound.m4a"></audio>

    <script>
        let currentLevel = 1, currentQ = 0, lives = 3;

        const qLvl1 = [
            { q: "Apa yang dibutuhkan tumbuhan untuk fotosintesis?", c: ["Oksigen", "Cahaya Matahari", "Susu"], a: 1 },
            { q: "Bagian tumbuhan yang menyerap air adalah?", c: ["Daun", "Batang", "Akar"], a: 2 },
            { q: "Zat hijau pada daun disebut?", c: ["Klorofil", "Oksigen", "Tanah"], a: 0 },
            { q: "Tumbuhan bernapas menghirup?", c: ["Karbon Dioksida", "Nitrogen", "Besi"], a: 0 },
            { q: "Akar pohon beringin yang menggantung?", c: ["Tunggang", "Gantung", "Serabut"], a: 1 }
        ];

        const qLvl2 = [
            { q: "Proses memasak makanan tumbuhan?", a: "fotosintesis" },
            { q: "Hasil fotosintesis yang kita hirup?", a: "oksigen" },
            { q: "Tumbuhan yang menyimpan air di batang?", a: "kaktus" },
            { q: "Tempat memasak makanan tumbuhan?", a: "daun" },
            { q: "Tumbuhan pemakan serangga?", a: "kantong semar" }
        ];

        const qLvl3 = [
            { q: "Aku bunga yang selalu mengikuti arah matahari. Siapakah aku?", c: ["Mawar", "Matahari", "Melati"], a: 1 },
            { q: "Aku tumbuhan yang menutup daun saat disentuh. Aku adalah...", c: ["Putri Malu", "Rumput", "Cemara"], a: 0 },
            { q: "Aku buah yang kulitnya berduri tapi dalamnya manis. Aku adalah...", c: ["Nanas", "Durian", "Salak"], a: 1 },
            { q: "Aku dikenal sebagai 'Emas Hijau' karena bermanfaat. Tumbuhan apa aku?", c: ["Padi", "Bambu", "Kelapa"], a: 2 },
            { q: "Tumbuhan yang akarnya bisa menembus tembok?", c: ["Beringin", "Lumut", "Parasit"], a: 0 }
        ];

        function startGame() {
            const name = document.getElementById('playerName').value;
            if(!name.trim()) return;
            document.getElementById('login-screen').style.display = 'none';
            document.getElementById('displayName').innerText = "üë®‚Äçüåæ " + name;
            document.getElementById('bgm').play();
            loadLevel();
        }

        function loadLevel() {
            lives = 3; updateHearts();
            if(currentLevel === 1) { 
                document.getElementById('area-quiz').style.display = 'block';
                document.getElementById('area-lvl2').style.display = 'none';
                showQuiz(qLvl1, "LEVEL 1: PILIHAN GANDA"); 
            } else if(currentLevel === 2) { 
                document.getElementById('area-quiz').style.display = 'none';
                document.getElementById('area-lvl2').style.display = 'block';
                showLvl2(); 
            } else { 
                document.getElementById('area-quiz').style.display = 'block';
                document.getElementById('area-lvl2').style.display = 'none';
                showQuiz(qLvl3, "LEVEL 3: TEKA-TEKI SULIT"); 
            }
        }

        function showQuiz(questions, label) {
            document.getElementById('levelLabel').innerText = label;
            const q = questions[currentQ];
            document.getElementById('question-box').innerText = (currentQ+1) + ". " + q.q;
            const optArea = document.getElementById('options-area');
            optArea.innerHTML = "";
            q.c.forEach((choice, i) => {
                let btn = document.createElement("button");
                btn.className = "btn-choice";
                btn.innerText = choice;
                btn.onclick = () => {
                    if(i === q.a) {
                        document.getElementById('sfxCorrect').play();
                        currentQ++;
                        if(currentQ < questions.length) showQuiz(questions, label);
                        else playWinState();
                    } else fail();
                };
                optArea.appendChild(btn);
            });
        }

        function showLvl2() {
            document.getElementById('levelLabel').innerText = "LEVEL 2: TEBAK KATA";
            document.getElementById('hint-box').innerText = (currentQ+1) + ". " + qLvl2[currentQ].q;
            document.getElementById('typeAnswer').focus();
        }

        function checkTypeAnswer() {
            const ans = document.getElementById('typeAnswer').value.toLowerCase().trim();
            if(ans === qLvl2[currentQ].a) {
                document.getElementById('sfxCorrect').play();
                currentQ++;
                document.getElementById('typeAnswer').value = "";
                if(currentQ < qLvl2.length) showLvl2();
                else playWinState();
            } else { fail(); document.getElementById('typeAnswer').value = ""; }
        }

        function playWinState() {
            // Hentikan BGM utama dan putar suara menang
            document.getElementById('bgm').pause();
            document.getElementById('sfxWin').currentTime = 0;
            document.getElementById('sfxWin').play();
            
            if (currentLevel === 3) {
                document.getElementById('winScreen').style.display = 'flex';
                document.getElementById('finalWinVid').play();
            } else {
                document.getElementById('levelUpScreen').style.display = 'flex';
                document.getElementById('winVid').play();
            }
        }

        function nextLevel() {
            currentLevel++; currentQ = 0;
            document.getElementById('levelUpScreen').style.display = 'none';
            document.getElementById('winVid').pause();
            document.getElementById('sfxWin').pause();
            document.getElementById('bgm').play();
            loadLevel();
        }

        function fail() {
            document.getElementById('sfxWrong').play();
            lives--; updateHearts();
            if(lives <= 0) {
                document.getElementById('bgm').pause();
                document.getElementById('sfxLose').play();
                document.getElementById('loseScreen').style.display = 'flex';
            }
        }

        function updateHearts() { document.getElementById('heartsContainer').innerText = "‚ù§Ô∏è".repeat(lives); }

        document.getElementById('typeAnswer').addEventListener('input', () => {
            const sound = document.getElementById('sfxType');
            sound.pause();
            sound.currentTime = 0;
            sound.play().catch(() => {});
        });
    </script>
</body>
</html>
